<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvaluaciÃ³n Club</title>

    <style>
        body {
            margin: 0;
            font-family: Arial, Helvetica, sans-serif;
            background: #f4f6f9;
        }

        .container {
            max-width: 800px;
            margin: auto;
            padding: 20px;
        }

        .card {
            background: white;
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
        }

        .pregunta {
            font-weight: bold;
            margin-bottom: 10px;
        }

        .opciones {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .opciones label {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            border-radius: 6px;
            background: #f1f1f1;
            cursor: pointer;
        }

        input[type="radio"] {
            transform: scale(1.2);
        }

        button {
            width: 100%;
            padding: 15px;
            font-size: 16px;
            background: #1e88e5;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        button:hover {
            background: #1565c0;
        }

        @media (min-width:600px) {
            .opciones {
                flex-direction: row;
                justify-content: space-between;
            }
        }

        .progress-container {
            width: 100%;
            background: #ddd;
            border-radius: 20px;
            overflow: hidden;
            height: 20px;
            margin-bottom: 10px;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: #4caf50;
            transition: width 0.3s ease;
        }

        .mensaje-exito {
            display: none;
            background: #e8f5e9;
            color: #2e7d32;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 15px;
            font-weight: bold;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-wrapper {
            position: sticky;
            top: 0;
            background: #f4f6f9;
            padding: 10px 0;
            z-index: 1000;
        }

        .progress-container {
            width: 100%;
            background: #ddd;
            border-radius: 20px;
            overflow: hidden;
            height: 20px;
        }

        .progress-bar {
            height: 100%;
            width: 0%;
            background: #4caf50;
            transition: width 0.3s ease;
        }

        #progressText {
            text-align: center;
            font-weight: bold;
            margin: 5px 0 0 0;
        }

        .progress-completo {
            animation: pulseGreen 0.6s ease-in-out;
            background: #2e7d32 !important;
        }

        @keyframes pulseGreen {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.03);
            }

            100% {
                transform: scale(1);
            }
        }

        .card.completada {
            opacity: 0.6;
            transition: all 0.3s ease;
        }

        .respuesta-final {
            font-weight: bold;
            color: #2e7d32;
            margin-top: 5px;
        }

        .info-alternativas {
            background: #ffffff;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
            margin-bottom: 20px;
            font-size: 14px;
        }

        .info-alternativas h3 {
            margin-top: 0;
            color: #1e88e5;
        }

        .info-alternativas ul {
            padding-left: 20px;
            margin: 10px 0 0 0;
        }

        .info-alternativas li {
            margin-bottom: 6px;
        }
    </style>
</head>

<body>

    <div class="container">

        <h1>EvaluaciÃ³n TÃ©cnica</h1>

        <div id="mensajeExito" class="mensaje-exito">
            âœ… EvaluaciÃ³n enviada correctamente
        </div>

        <div class="progress-wrapper">
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <p id="progressText">0% completado</p>
            <p id="preguntaActual"></p>
        </div>

        <form id="formulario">

            <div class="card">
                <input type="text" id="nombre" placeholder="Nombre completo" required
                    style="width:100%;padding:10px;margin-bottom:10px;">
                <input type="number" id="anioIngreso" placeholder="AÃ±o ingreso al polo" required
                    style="width:100%;padding:10px;margin-bottom:10px;">
                <input type="number" id="nacionales" placeholder="Torneos nacionales" required
                    style="width:100%;padding:10px;margin-bottom:10px;">
                <input type="number" id="internacionales" placeholder="Torneos internacionales" required
                    style="width:100%;padding:10px;margin-bottom:10px;">
                <input type="number" id="latinos" placeholder="Latinoamericanos" required
                    style="width:100%;padding:10px;margin-bottom:10px;">
                <input type="number" id="somos" placeholder="Torneos Somos" required
                    style="width:100%;padding:10px;margin-bottom:10px;">
                <input type="number" id="wildcard" placeholder="Wild Card / Mundiales" required
                    style="width:100%;padding:10px;margin-bottom:10px;">

                <p>Â¿Participas activamente en ligas?</p>
                <label><input type="radio" name="ligas" value="Si" required> SÃ­</label>
                <label><input type="radio" name="ligas" value="No"> No</label>
            </div>

            <div class="info-alternativas">
                <h3>Instrucciones</h3>
                <p>Marca la alternativa que mÃ¡s se acerque a tu juego, de acuerdo a las siguientes descripciones:</p>

                <ul>
                    <li><strong>SIEMPRE:</strong> 8 a 10 de 10 veces puedo hacerlo bien sin fallas.</li>
                    <li><strong>A VECES:</strong> 4 a 6 de 10 veces puedo hacerlo, pero no siempre me sale bien.</li>
                    <li><strong>NUNCA:</strong> Menos de 3 de 10 veces me sale bien, en general me ayuda bastante la
                        suerte.</li>
                </ul>
            </div>


            <div id="preguntas"></div>

            <div class="card">
                <button type="submit" id="btnEnviar" disabled>Enviar EvaluaciÃ³n</button>
            </div>

        </form>

    </div>

    <script>

        const endpoint = "https://script.google.com/macros/s/AKfycbw3pzGgJZzKmsNn9Vp-TZ2H01zNd2CqaSVwkog80_euM8_Ju2dsLMBm15ISzawt5deh/exec";

        const preguntas = [
            "Presionar la pelota contra el piso con lado hueco del cabezal (scoop)",
            "Mantener el equilibrio posicionado en lugar especÃ­fico, bicicleta detenida y mallet bien apoyado en el suelo",
            "Fuera de un partido: Bajar mallet al piso mientras la bici estÃ© en movimiento/tocar piso con la mano",
            "Saltar encalado (o no) con ambas ruedas, repetidamente, girando en el eje de la caja de motor",
            "Armado, coordinaciÃ³n y direcciÃ³n de equipo en un partido",
            "Dar vuelta en cÃ­rculo con una mano en el manubrio y la otra inicialmente apoyando el mallet",
            "Nociones avanzadas de posiciones en la cancha",
            "Pasar la pelota de un lado al otro de la bici utilizando scoop hacia ambos lados",
            "Llevar la pelota una vuelta completa a la cancha en donde yo la quiero",
            "Pedalear y frenar idealmente con una mano",
            "Pases con rueda delantera",
            "Pivoteo continuo con ambas ruedas",
            "Dar un pase con el lado largo de la cabeza",
            "No caerse en situaciones de carrera y frenar bruscamente",
            "Bajar mallet al piso para tapar una pelota bajo caja de motor en el arco",
            "Pivoteo en +90Â° con ambas ruedas",
            "Recibir un pase por tu lado hÃ¡bil",
            "Dar un pase por tu lado hÃ¡bil",
            "Dar pases o tiros direccionados",
            "Bajar mallet para interferir pases",
            "En movimiento recto: Saltar con ambas ruedas para cambiar direcciÃ³n",
            "Bajar mallet para defender el arco y volver a posiciÃ³n",
            "Hablar de forma tÃ¡ctica para coordinaciÃ³n de equipo",
            "Conducir la bicicleta con una mano",
            "Llevar pelota por delante moviendo la bici de lado a lado",
            "Utilizar scoop dentro de partidos",
            "Scoop de revÃ©s",
            "Nociones bÃ¡sicas de posicionamiento en la cancha",
            "Hacer un tiro por tu lado hÃ¡bil",
            "Nociones de juego en pared y esquinas",
            "UtilizaciÃ³n de la bicicleta para ganar posiciÃ³n",
            "Recibir pase, preparar tiro y tirar de primera",
            "Lectura de partidos",
            "Pasar la pelota de un lado al otro por caja de motor 2 veces",
            "Entrar al Ã¡rea y mantener posiciÃ³n de arquero",
            "Saltar repetidamente moviÃ©ndose adelante, atrÃ¡s y lados",
            "Buenas salidas en situaciones en pared",
            "Pases con rueda trasera",
            "Dar un pase hacia atrÃ¡s",
            "Llevar la pelota por ambos lados de la bici",
            "Scoop sin bicicleta hacia arriba",
            "Pivotear en 45Â° con rueda trasera",
            "Recibir pase, preparar tiro y tirar en 3 movimientos",
            "Juego con las manos controlando pelotas aÃ©reas",
            "Pivotear en +45Â° con rueda delantera",
            "Acomodar la bicicleta al arco",
            "Recibir un pase por tu lado no hÃ¡bil",
            "Frenar con rueda delantera y levantar rueda trasera",
            "Recibir pase, preparar tiro y tirar en 2 movimientos",
            "Pivotear en 90Â° con rueda trasera",
            "Tiro al arco desde cualquier parte de la cancha",
            "Defender 1v1 cerca del Ã¡rea por ambos lados",
            "Scoop bÃ¡sico con bicicleta hacia arriba"
        ];

        const contenedor = document.getElementById("preguntas");


        // ðŸ”¥ Generar preguntas dinÃ¡micamente
        preguntas.forEach((texto, index) => {

            const numero = index + 1;

            if (numero % 10 === 1) {
                const separador = document.createElement("div");
                separador.innerHTML = `<h3 style="margin-top:30px;">Bloque ${Math.ceil(numero / 10)}</h3>`;
                contenedor.appendChild(separador);
            }

            const card = document.createElement("div");
            card.className = "card";

            card.innerHTML = `
        <div class="pregunta">${numero}. ${texto}</div>
        <div class="opciones">
            <label><input type="radio" name="p${numero}" value="3" required> Siempre</label>
            <label><input type="radio" name="p${numero}" value="2"> A veces</label>
            <label><input type="radio" name="p${numero}" value="1"> Nunca</label>
        </div>
    `;

            contenedor.appendChild(card);

            card.querySelectorAll("input[type='radio']").forEach(radio => {
                radio.addEventListener("change", function () {

                    actualizarProgreso();

                    // ðŸ”¥ Guardar respuesta pregunta
                    localStorage.setItem(this.name, this.value);

                    const cardActual = this.closest(".card");

                    if (cardActual.classList.contains("completada")) return;

                    const opciones = cardActual.querySelector(".opciones");
                    opciones.style.display = "none";

                    const respuestaFinal = document.createElement("div");
                    respuestaFinal.className = "respuesta-final";
                    respuestaFinal.innerText = "Respuesta: " + this.parentElement.innerText;

                    cardActual.appendChild(respuestaFinal);
                    cardActual.classList.add("completada");

                    const numeroActual = parseInt(this.name.replace("p", ""));
                    const siguiente = document.querySelector(`input[name="p${numeroActual + 1}"]`);

                    if (siguiente) {
                        siguiente.closest(".card").scrollIntoView({
                            behavior: "smooth",
                            block: "center"
                        });
                    }
                });
            });

        });


        // ðŸ”¥ GUARDAR CAMPOS INFORMATIVOS AUTOMÃTICAMENTE
        const camposInfo = [
            "nombre",
            "anioIngreso",
            "nacionales",
            "internacionales",
            "latinos",
            "somos",
            "wildcard"
        ];

        camposInfo.forEach(id => {
            const input = document.getElementById(id);
            if (input) {
                input.addEventListener("input", function () {
                    localStorage.setItem(id, this.value);
                });
            }
        });

        // Guardar radio ligas
        document.querySelectorAll('input[name="ligas"]').forEach(radio => {
            radio.addEventListener("change", function () {
                localStorage.setItem("ligas", this.value);
            });
        });


        // ðŸ”¥ RESTAURAR PROGRESO PREGUNTAS
        preguntas.forEach((_, index) => {

            const numero = index + 1;
            const valorGuardado = localStorage.getItem("p" + numero);

            if (valorGuardado) {

                const radio = document.querySelector(`input[name="p${numero}"][value="${valorGuardado}"]`);

                if (radio) {

                    radio.checked = true;

                    const cardActual = radio.closest(".card");
                    const opciones = cardActual.querySelector(".opciones");
                    opciones.style.display = "none";

                    const respuestaFinal = document.createElement("div");
                    respuestaFinal.className = "respuesta-final";
                    respuestaFinal.innerText = "Respuesta: " + radio.parentElement.innerText;

                    cardActual.appendChild(respuestaFinal);
                    cardActual.classList.add("completada");
                }
            }
        });


        // ðŸ”¥ RESTAURAR CAMPOS INFORMATIVOS
        camposInfo.forEach(id => {
            const valor = localStorage.getItem(id);
            if (valor) {
                const input = document.getElementById(id);
                if (input) input.value = valor;
            }
        });

        // Restaurar ligas
        const ligasGuardado = localStorage.getItem("ligas");
        if (ligasGuardado) {
            const radio = document.querySelector(`input[name="ligas"][value="${ligasGuardado}"]`);
            if (radio) radio.checked = true;
        }


        // ðŸ”¥ Actualizar barra despuÃ©s de restaurar
        actualizarProgreso();


        // ðŸ”¥ Barra de progreso
        function actualizarProgreso() {

            let respondidas = 0;

            for (let i = 1; i <= preguntas.length; i++) {
                const seleccion = document.querySelector(`input[name="p${i}"]:checked`);
                if (seleccion) respondidas++;
            }

            const porcentaje = Math.round((respondidas / preguntas.length) * 100);

            const barra = document.getElementById("progressBar");
            const texto = document.getElementById("progressText");
            const btn = document.getElementById("btnEnviar");

            if (barra) barra.style.width = porcentaje + "%";
            if (texto) texto.innerText = porcentaje + "% completado";

            if (porcentaje === 100) {
                btn.disabled = false;
                barra.style.background = "#2e7d32";
            } else {
                btn.disabled = true;
                barra.style.background = "#4caf50";
            }

            for (let i = preguntas.length; i >= 1; i--) {
                const seleccion = document.querySelector(`input[name="p${i}"]:checked`);
                if (seleccion) {
                    document.getElementById("preguntaActual").innerText =
                        "Ãšltima respondida: " + i + " de " + preguntas.length;
                    break;
                }
            }
        }


        // ðŸ”¥ EnvÃ­o del formulario
        document.getElementById("formulario").addEventListener("submit", function (e) {

            e.preventDefault();

            let puntaje = 0;

            for (let i = 1; i <= preguntas.length; i++) {
                const respuesta = document.querySelector(`input[name="p${i}"]:checked`);
                puntaje += parseInt(respuesta.value);
            }

            let nivel = "";

            if (puntaje <= 74) nivel = "Inicial";
            else if (puntaje <= 96) nivel = "Inicial(+)";
            else if (puntaje <= 118) nivel = "Intermedio";
            else if (puntaje <= 140) nivel = "Intermedio(+)";
            else nivel = "Avanzado";

            const data = {
                nombre: document.getElementById("nombre").value,
                anioIngreso: document.getElementById("anioIngreso").value,
                nacionales: document.getElementById("nacionales").value,
                internacionales: document.getElementById("internacionales").value,
                latinos: document.getElementById("latinos").value,
                somos: document.getElementById("somos").value,
                wildcard: document.getElementById("wildcard").value,
                ligas: document.querySelector('input[name="ligas"]:checked').value,
                puntaje,
                nivel
            };

            const formData = new FormData();
            Object.keys(data).forEach(key => formData.append(key, data[key]));

            const btn = document.getElementById("btnEnviar");
            btn.disabled = true;
            btn.innerText = "Enviando...";

            fetch(endpoint, {
                method: "POST",
                body: formData
            })
                .then(() => {

                    // ðŸ”¥ LIMPIAR TODO EL PROGRESO
                    localStorage.clear();

                    const mensaje = document.getElementById("mensajeExito");
                    mensaje.style.display = "block";

                    window.scrollTo({
                        top: 0,
                        behavior: "smooth"
                    });

                    document.getElementById("formulario").reset();
                    actualizarProgreso();

                    btn.innerText = "Enviar EvaluaciÃ³n";

                    setTimeout(() => {
                        mensaje.style.display = "none";
                    }, 4000);

                })
                .catch(error => {
                    console.error("Error:", error);
                    btn.disabled = false;
                    btn.innerText = "Enviar EvaluaciÃ³n";
                });

        });

    </script>



</body>

</html>